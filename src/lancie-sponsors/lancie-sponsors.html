<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../../bower_components/neon-animation/neon-shared-element-animatable-behavior.html">
<link rel="import" href="../../bower_components/paper-styles/shadow.html">

<dom-module id="lancie-sponsors">
  <template>
    <style include="iron-flex iron-flex-alignment iron-flex-factors"></style>
    <style>
      :host {
        display: block;
        width: 100%;
        --logo-width: 210px;
        line-height: 0px;
      }

      img {
        object-fit: contain;
        width: var(--logo-width);
      }

      .main-sponsors img {
        margin-right: 32px;
      }

      .premium-sponsors a {
        height: 100%;
        margin: auto 6px;
      }

      #jigsawLogo {
        height: 130px;
      }

      /*
       * Safari hack
       * Makes flex wrapping work
       */
      .flex, .flex-1, .flex-2, .flex-3, .flex-4 {
        flex-basis: var(--logo-width);
      }
      /*End Safari hack*/
    </style>

    <lancie-ajax
      id="ajaxSponsor"
      refurl="/web/sponsor"
      handle-as="json"
      on-response="onResponse"
    ></lancie-ajax>

    <div id="grid" class="layout horizontal wrap flex">
      <div class="layout vertical flex-1 main-sponsors">
        <h3>Presented by</h3>
        <template is="dom-repeat" items="[[presenters]]" as="presenter">
          <a href="[[presenter.website]]" target="_blank" rel="noopener noreferrer"><img src="../../[[presenter.imageName]]"></a>
        </template>
      </div>
      <div class="layout vertical flex-4">
        <h3>Premium sponsors</h3>
        <div class="layout horizontal wrap premium-sponsors">
          <template is="dom-repeat" items="[[premiums]]" as="premium">
            <a href="[[premium.website]]" target="_blank" rel="noopener noreferrer"><img src="../../[[premium.imageName]]"></a>
          </template>
        </div>
      </div>
      <div class="layout vertical flex-4">
        <h3>Sponsors</h3>
        <div class="layout horizontal wrap regular-sponsors">
          <template is="dom-repeat" items="[[normals]]" as="normal">
            <a href="[[normal.website]]" target="_blank" rel="noopener noreferrer"><img src="../../[[normal.imageName]]"></a>
          </template>
        </div>
      </div>
    </div>

  </template>
  <script>
    (function() {
      'use strict';

      Polymer({
        is: 'lancie-sponsors',
        properties: {
          sponsors: Array,
          presenters: Array,
          premiums: Array,
          normals: Array
        },

        attached: function () {
          this.$.ajaxSponsor.generateRequest();
        },

        onResponse: function (e, request) {
          if (request.succeeded) {
            this.sponsors = request.response.object;
            this.presenters = this.sponsors.filter(function(sponsor) {
              return sponsor.type === "PRESENTER";
            });
            this.premiums = this.sponsors.filter(function(sponsor) {
              return sponsor.type === "PREMIUM";
            });
            this.normals = this.sponsors.filter(function(sponsor) {
              return sponsor.type === "NORMAL";
            });
          }
        }
      });
    })();
  </script>
</dom-module>
