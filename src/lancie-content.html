<link rel="import" href="../bower_components/app-route/app-location.html">
<link rel="import" href="../bower_components/app-route/app-route.html">
<link rel="import" href="../bower_components/iron-lazy-pages/iron-lazy-pages.html">

<link rel="import" href="lancie-storage/lancie-auth-storage.html">
<link rel="import" href="lancie-login/lancie-ajax.html">
<link rel="import" href="lancie-login/lancie-login-check.html">
<link rel="import" href="lancie-contact/lancie-contact.html">
<link rel="import" href="lancie-contact/lancie-contact-success.html">

<dom-module id="lancie-content">
  <template>
    <style>
      :host {
        display: block;
        min-height: calc(100vh - /*Height of footer*/ 272px - /*Height of top bar*/ 64px);
      }
    </style>

    <lancie-auth-storage id="auth" user={{user}}></lancie-auth-storage>

    <app-location route="{{route}}"></app-location>
    <app-route route="{{route}}" pattern="/:page" data="{{page}}"></app-route>

    <iron-lazy-pages attr-for-selected="data-route" selected="{{page.page}}" fallback-selection="404">

      <template is="iron-lazy-page" data-route="" path="src/lancie-home-page/lancie-home-page.html">
        <lancie-home-page></lancie-home-page>
      </template>

      <template is="iron-lazy-page" data-route="my-area" path="src/lancie-my-area/lancie-my-area.html">
        <lancie-login-check user="{{user}}">
          <lancie-my-area user="{{user}}"></lancie-my-area>
        </lancie-login-check>
      </template>

      <template is="iron-lazy-page" data-route="accept-transfer" path="src/lancie-my-area/lancie-accept-ticket-transfer.html">
        <lancie-login-check user="{{user}}">
          <lancie-accept-ticket-transfer></lancie-accept-ticket-transfer>
        </lancie-login-check>
      </template>

      <template is="iron-lazy-page" data-route="transfer-success" path="src/lancie-my-area/lancie-success-ticket-transfer.html">
        <lancie-success-ticket-transfer></lancie-success-ticket-transfer>
      </template>

      <template is="iron-lazy-page" data-route="tickets" path="src/lancie-ticket-page/lancie-ticket-page.html">
        <lancie-login-check user="{{user}}">
          <lancie-ticket-page route="{{page.page}}" user="{{user}}"></lancie-ticket-page>
        </lancie-login-check>
      </template>

       <template is="iron-lazy-page" data-route="seatmap" path="src/lancie-seatmap/lancie-seatmap.html">
        <lancie-login-check user="{{user}}">
          <lancie-seatmap user="{{user}}"></lancie-seatmap>
        </lancie-login-check>
      </template>

      <template is="iron-lazy-page" data-route="rfid" path="src/lancie-rfid/lancie-rfid.html">
        <lancie-login-check user="{{user}}">
          <lancie-rfid route="{{page.page}}" user="{{user}}"></lancie-rfid>
        </lancie-login-check>
      </template>

      <template is="iron-lazy-page" data-route="tickets-intercept" path="src/lancie-ticket-page/lancie-ticket-profile-intercept.html">
        <lancie-ticket-profile-intercept route="{{page.page}}" user="{{user}}"></lancie-ticket-profile-intercept>
      </template>

      <template is="iron-lazy-page" data-route="confirmRegistration" path="src/lancie-login/lancie-register-confirmation.html">
        <lancie-register-confirmation></lancie-register-confirmation>
      </template>

      <template is="iron-lazy-page" data-route="check-email" path="src/lancie-login/lancie-check-email.html">
        <lancie-check-email></lancie-check-email>
      </template>

      <template is="iron-lazy-page" data-route="ordersuccess" path="src/lancie-order-check.html">
        <lancie-order-check></lancie-order-check>
      </template>

      <template is="iron-lazy-page" data-route="404" path="src/lancie-404.html">
        <lancie-404></lancie-404>
      </template>

      <template is="iron-lazy-page" data-route="resetPassword" path="src/lancie-password/lancie-password-reset.html">
        <lancie-password-reset></lancie-password-reset>
      </template>

      <template is="iron-lazy-page" data-route="password-reset-success" path="src/lancie-password/lancie-password-reset-success.html">
        <lancie-password-reset-success></lancie-password-reset-success>
      </template>

      <template is="iron-lazy-page" data-route="request-password-reset" path="src/lancie-password/lancie-request-password-reset.html">
        <lancie-request-password-reset></lancie-request-password-reset>
      </template>

      <template is="iron-lazy-page" data-route="request-password-reset-success" path="src/lancie-password/lancie-request-password-reset-success.html">
        <lancie-request-password-reset-success></lancie-request-password-reset-success>
      </template>

      <template is="iron-lazy-page" data-route="contact" path="src/lancie-contact/lancie-contact.html">
        <lancie-contact></lancie-contact>
      </template>

      <template is="iron-lazy-page" data-route="contact-success" path="src/lancie-contact/lancie-contact-success.html">
        <lancie-contact-success></lancie-contact-success>
      </template>

    </iron-lazy-pages>
  </template>
  <script>
  (function() {
  'use strict';

    Polymer({
      is: 'lancie-content',
      properties: {
        route: {
          type: String,
          notify: true
        },
        user: {
          type: Object
        },
      },

      ready: function() {
        this.addEventListener('store-token', function(e) {
          this.$.auth.storeToken(e.detail.token);
        });
      },

      _matches: function(path, route) {
        return path === route;
      },
    });
  })();
  </script>
</dom-module>
