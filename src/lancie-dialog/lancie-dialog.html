<link rel="import" href="../../bower_components/polymer/polymer.html">

<!--
`lancie-dialog`
Dialog for the lancie frontends

@demo demo/index.html
-->

<dom-module id="lancie-dialog">
  <template>
    <style>
      #actualDialog {
        display: none;
        position: fixed;
        width: 400px;
        left: 0;
        right: 0;
        top: 30vh;
        margin: auto;
        z-index: 11;

        background-color: white;
      }

      #actualDialog ::content h2 {
        background-color: var(--primary-color);
        color: var(--secondary-color);
        margin: 0;
        font-size: 24px;
        font-weight: 400;
      }

      #actualDialog ::content h2,
      #actualDialog ::content .card-content {
        padding: 16px;
      }

      #actualDialog ::content .buttons {
        border-top: 1px solid #e8e8e8;
        padding: 8px 24px;
        margin: 0;

        @apply(--layout-horizontal);
        @apply(--layout-end-justified);
      }

      #actualDialog ::content .full-width .btn {
        margin: 0 4px;
        width: calc(50% - 8px);
      }

      #actualDialog ::content .buttons .btn-primary {
        color: var(--secondary-color);
        background: var(--primary-color);
      }

      #backdrop {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: black;
        opacity: 0;
        z-index: 10;
        transition: opacity 0.1s linear;
      }

    </style>
    <div id="actualDialog">
      <content></content>
    </div>

    <div id="backdrop" on-tap="close"></div>
  </template>

  <script>
  'use strict';

  (function() {
    Polymer({
      is: 'lancie-dialog',
      listeners: {
        'tap': 'isDismissButton'
      },

      /**
      * Find out if the tapped target was the dismiss button
      */
      isDismissButton: function(event) {
        // Search for the element with dialog-dismiss,
        // from the root target until this (excluded).
        var path = Polymer.dom(event).path;
        for (var i = 0; i < path.indexOf(this); i++) {
          var target = path[i];
          if (target.hasAttribute && (target.hasAttribute('dialog-dismiss') )) {
            this.close();
            event.stopPropagation();
            break;
          }
        }
      },

      /**
       * Opens the lancie-dialog
       * @return {void}
       */
      open: function() {
        this.$.actualDialog.style.display = 'block';
        this.$.backdrop.style.display = 'block';
        this.async(function() {
          this.$.backdrop.style.opacity = '0.6';
        }, 1);
      },

      /**
      * Closes the lancie-dialog
      * @return {void}
      */
      close: function() {
        this.$.actualDialog.style.display = 'none';
        this.$.backdrop.style.display = 'none';this.$.backdrop.style.opacity = '0.0';
      }
    });
  })();
  </script>
</dom-module>
